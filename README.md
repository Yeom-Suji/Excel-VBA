![header](https://capsule-render.vercel.app/api?type=waving&color=gradient&height=200&section=header&text=Excel%20VBA&fontSize=50)

## _Trying to handle Visual Basic Analysis efficiently_ 📈

<img src="https://img.shields.io/badge/Excel&nbsp;VBA-217346?style=for-the-badge&logo=Microsoft&logoColor=white">
<br/>

☘️RPA 시대
🔸Data Digital Transformation

🔸데이터를 의심하고 검증하라(데이터가 분석 바람직?)
1. 정형? 비정형?
2. 일반 데이터 범위  <> 표 개체 : 필드 삽입, 수식, 슬라이서 삽입, 요약행
3. 데이터 ???
4. 필드별 데이터 타입?
     

🔸 표 개체
1. 동적 범위로 자동으로 잡아준다
2. 필드 단위 계산 : 구조적 참조

🔸파워쿼리로 가공하는 표준 프로세스
일반 데이터범위 > 표 개체 > 파워쿼리로 불러가서 가공 > 워크시트로 로드
> 원본 업뎃 > 쿼리내에서 새로고침 > 자동화  > 검증

🔸미션1
현재 통합문서에
'시청자수 Top 20' 데이터 테이블을
새로운 시트로 웹스크래핑

🔸미션2
시트통합 진행 > 검증까지!
3:47

🔸원본데이터 설정
원본 폴더 or 원본 파일의
경로가 바뀌거나
이름이 바뀌면

🔸양질 데이터 수집
KOSIS
서울열린데이터광장
부산광역시 빅데이터플랫폼
빅카인즈/썸트렌드
kaggle
gapminder
KDX 한국데이터거래소

🔸크로스테이블 : 보고서 용도로는 바람직, 데이터 분석 용도X


🔸미션3
데이터 구조화 > 검증
5:04

🔸데이터 취합(파일통합X, 시트통합X)
1. UNION
흩어진 데이터 테이블들을 파워쿼리가 인지하도록 '연결전용' 으로 만들어준다

일반 데이터 범위 > 표 개체 > 파워쿼리로 가져가기 > 연결전용으로 로드
 > union으로 합치기



2. JOIN
- 표 개체 > 파워쿼리로 가져가기 > 워크시트로 로드 > 연결전용
- 연결전용 완료된 쿼리에서 > 우클 > 병합 > primary key 선택 > 조인 옵션 선택 > 확인
- 검증!!!

🔸데이터 조인하기
깨끗한 통합문서 열기 > 파워쿼리로 데이터 가져오기 > 파워쿼리로 편집 
> 워크시트로 로드 : 연결전용 > 데이터 테이블들 JOIN > 최종 취합 쿼리테이블만
워크시트로 로드

☘️데이터 분석이 왜 중요한가?

데이터 분석을 통해 인사이트 도출 > 기업 가치창출, 의사결정
- 양질의 데이터 플랫폼 다수 등장
- 빅데이터 분석을 위한 소프트웨어 등장
- 데이터 분석, 설득, 조직 

☘️시각적분석 : 어떤 연령대별, 대륙별  21년 2월 인천공항에서 가장 많이 출국?
raw data 체크 > 일반 데이터범위 > 표 개체 > 파워쿼리로 가져가기 > 편집
> 워크시트로 로드 > 기본분석 : pivot table > 쿼리 내에 셀 포인터 선택 >  리본메뉴
> 삽입: 피벗테이블 > 시각적분석(가독성) : 보고서레이아웃(테이블 형식), 조건부서식 > 정적분석 > 동적분석 : 슬라이서 > 보고서연결

🔸시각적분석 대시보드 설계 시
1. 안정성 : 에러 없어야 함(데이터 정합성, 데이터 신뢰도 확보)
2. 처리속도

🔸시각적분석 : 태블로 , Power Bi
1. 시각화?
2. 현재 현업의 많은 데이터들이 엑셀의 수식(함수)을 사용해서 설계 > 데이터베이스화 X > 새로운 보고서 작성X
3. 가장 어려운 점 : 데이터 구조화

🔸Open API 방식으로 시각적분석

경기도 군포시, 23년 1~2월, 남여별, 25~29세 , 실업급여 현황 분석

과제 제출
엑셀 파일 > 압축(zip) 해서 > 공유 폴더 업로드
3월 28일 24시 까지 업로드

🔸스트레스 인지율과 자살시도율이 서로 상관관계?
      만약에 두 개의 변수가 서로 상관관계 있다고 하면
      스트레스 인지율 변화에 따른(독립변수)
     자살 시도율을 예측해보고 싶다(종속변수)

회귀분석
단순 회귀분석 : 독립변수1, 종속변수1
 회귀식(회귀모형) :  y=aX + b



다중 회귀분석
로지스틱...

🔸노가다 >    파워쿼리           > VBA

🔸VBA
🔸코딩 전용 글꼴 : 네이버, 무료 배포/ 나눔고딕코딩

🔸엑셀 개체 모델 : 족보
      application > workbooks > worksheets > range  / cells

🔸외우기
Cells(Rows.Count, "a").End(xlup)
Range("a1").CurrentRegion

1. 개체.메서드
2. 개체.속성 = 속성값

🔸지우기메서드(3가지) : 
🔸색칠하기(3가지) :

🔸코딩 시 : 동료의 관점에서 디자인, 코딩하라
1. 안정성
2. 처리속도
   - with 문
   - 변수 활용
   - 배열변수 활용
   - 엑셀 기능 활용
3. 로직?
   - 결과물을 그림으로 그려봐라
   - 반복되는 패턴 : 행 반복? 열 반복?
4. 동료의 엑셀 라이프 스타일까지 고려해서 코딩.
       

🔸변수
1. 일반 변수 : 변수에 들어온 값이 숫자, 문자, 날짜, 논리값 등등

변수1 = A열에 데이터가 있는 마지막 셀의 행번호
변수2 = A1셀을 기준으로 연속된 데이터 범위의 행개수
변수3 = "한국직업개발원"



2. 개체 변수 : 엑셀의 개체(셀, 시트, 파일, 피벗테이블, 차트..)를 변수로 받음
dim 변수5 as worksheet
set 변수5 = sheets("취합")


dim 변수6 as range
set 변수6 = sheets("취합").range("a1")

dim 변수7 as range
set 변수7 =sheets("취합").range("a1").currentregion

dim 변수8 as integer
변수8 = sheet1.cells(rows.count,"a").end(3).row


🔸비교연산자
이상: >=
이하: <=
초과: >
미만: <
같다: =
같지않다: <>

🔸실무버전 업그레이드
1. 매크로 버튼으로 빼기
2. 데이터가 있는 마지막셀의 행번호 > 변수
3. 기존 데이터 지우기
4. Application.ScreenUpdating = False / True
5. 처리속도 체크 (4줄)

🔸vba 매크로
1. 일반 매크로 : 맨 땅에 헤딩

2. 자동 매크로 : 엑셀 워크시트 창에서 메뉴 클릭을 통해 작업하는 과정을
     엑셀이 자동으로 vba 언어로 바꾸어준 매크로
   - 처리속도가 어마무시하게 느리다
   - 자동 매크로로 기록이 안되는 작업들이 많다.
예> 출력 : 매크로

🔸회귀분석(regression)
1. 단순 회귀분석 : 독립변수1, 종속변수1
     회귀식(회귀모형) : y=aX+b

	1인당 국민총소득 변화에 따른
       운전면허소지자 수를 과학적으로 예측.

2. 다중 회귀분석 : 독립변수 여러개, 종속변수1

🔸미션
회귀분석 매크로 버튼을 클릭했을 때
분석도구, 분석도구-VBA 툴이 활성화되는 코드까지
현재 매크로에 추가하라!


GetData
Visualization


☘️ 
1. software 
2. 프로젝트 과제
3. 파워쿼리 에러

4. 데이터분석을 통해 가치창출



☘️프로젝트 과제2

1. - 주문 시트에 데이터 가져오기
     - Dashboard 시트에 : 피벗 테이블(고객세그먼트별, 지역별) + 차트 그려지기
     - 주문 시트에 매크로 버튼 생성
     - 위 3가지 항목 필수
     - 추가로 고도화 하시는 것도 가능

2. 파일명 : VBA_홍길동.xlsm  😎파일은 압축해서 업로드 해야 함.

3. 시각: 13:45까지 공유 폴더에 업로드 완료하기

4. 과제가 끝나신 분들은
     학습 파일, 메모 등 정리
